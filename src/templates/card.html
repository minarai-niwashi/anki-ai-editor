{% extends "base.html" %}
{% block title %}カード {{ note_id }}{% endblock %}

{% block content %}
<h2 class="title is-4">質問</h2>
<p class="content">{{ question | safe }}</p>

{% if diff_html %}
  <h3 class="title is-5 mt-5">差分プレビュー</h3>
  <div class="box diff-table">{{ diff_html | safe }}</div>
{% endif %}

<form method="post">
  <div class="field">
    <label class="label">答え（編集可能）</label>
    <div class="control">
      <textarea name="answer">{{ answer }}</textarea>
    </div>
  </div>

  <div class="buttons mt-4">
    <button class="button is-primary" name="action" value="update">✅ 更新</button>
    {% if not already_edited %}
      <button class="button is-info" name="action" value="refine">🤖 推敲する</button>
    {% else %}
      <button class="button is-info" name="action" value="refine">🔁 再推敲</button>
    {% endif %}
  </div>
</form>

<p class="mt-4">
  <a href="{{ url_for('deck', deck_name=deck_name, page=request.args.get('page', 1)) }}">← カード一覧へ戻る</a>
</p>
{% endblock %}
